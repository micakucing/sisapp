(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[505],{40482:(e,a,t)=>{"use strict";t.d(a,{A:()=>r});var s=t(37876),n=t(48230),l=t.n(n),i=t(89099),c=t(10323),d=t(14232);function r(){let e=(0,i.useRouter)();(0,c.xI)();let[a,t]=(0,d.useState)(!1),[n,r]=(0,d.useState)(!1);return(0,d.useEffect)(()=>{let e=()=>{r(window.innerWidth<992),window.innerWidth>=992&&t(!0)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,s.jsxs)(s.Fragment,{children:[n&&(0,s.jsx)("button",{style:{position:"absolute",right:"0px"},className:"btn btn-dark m-2",onClick:()=>t(!a),children:"â˜° Menu"}),(0,s.jsxs)("div",{className:"bg-dark text-light position-fixed vh-100 p-3 transition",style:{width:"220px",zIndex:1e3,top:"0px",left:a?"0":"-240px",transition:"left 0.3s ease"},children:[(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsx)("h5",{children:"SIS Dashboard"})}),(0,s.jsx)("ul",{className:"nav nav-pills flex-column mb-auto",children:[{name:"Dashboard",href:"/dashboard"},{name:"Kelas",href:"/classes"},{name:"Siswa",href:"/admin/students/siswa"},{name:"Absensi",href:"/attendance"},{name:"Rekap",href:"/reports"}].map(a=>(0,s.jsx)("li",{className:"nav-item",children:(0,s.jsx)(l(),{href:a.href,className:"nav-link text-light ".concat(e.pathname===a.href?"active bg-primary":""),children:a.name})},a.href))})]})]})}},66020:(e,a,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/attendance",function(){return t(91567)}])},91567:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>d});var s=t(37876),n=t(14232),l=t(20485),i=t(98467),c=t(40482);function d(){let[e,a]=(0,n.useState)([]),[t,d]=(0,n.useState)([]),[r,o]=(0,n.useState)([]),[h,m]=(0,n.useState)(""),[u,x]=(0,n.useState)(""),[j,p]=(0,n.useState)(1),v=async()=>{o((await (0,l.GG)((0,l.rJ)(i.db,"classes"))).docs.map(e=>({id:e.id,...e.data()})))},b=async()=>{let e=(0,l.P)((0,l.rJ)(i.db,"attendance"),(0,l.My)("date","desc"));a((await (0,l.GG)(e)).docs.map(e=>({id:e.id,...e.data()})))};(0,n.useEffect)(()=>{v(),b()},[]),(0,n.useEffect)(()=>{let a=e;if(h&&(a=a.filter(e=>e.kelasId===h)),u){let e=u.toLowerCase();a=a.filter(a=>a.name.toLowerCase().includes(e))}d(a),p(1)},[e,h,u]);let f=10*j,k=t.slice(f-10,f),g=Math.ceil(t.length/10);return(0,s.jsxs)("div",{className:"d-flex",children:[(0,s.jsx)(c.A,{}),(0,s.jsxs)("div",{className:"flex-grow-1 p-4",style:{marginLeft:"220px"},children:[(0,s.jsx)("h2",{className:"mb-4",children:"Rekap Absensi"}),(0,s.jsxs)("div",{className:"row mb-3",children:[(0,s.jsx)("div",{className:"col-md-3 mb-2",children:(0,s.jsxs)("select",{className:"form-select",value:h,onChange:e=>m(e.target.value),children:[(0,s.jsx)("option",{value:"",children:"-- Semua Kelas --"}),r.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id))]})}),(0,s.jsx)("div",{className:"col-md-3 mb-2",children:(0,s.jsx)("input",{type:"text",className:"form-control",placeholder:"Cari nama siswa",value:u,onChange:e=>x(e.target.value)})}),(0,s.jsx)("div",{className:"col-md-3 mb-2",children:(0,s.jsx)("button",{className:"btn btn-primary",onClick:()=>{if(!t||0===t.length)return void alert("Tidak ada data untuk diexport!");let e=new Blob([[["Nama","Kelas","Check-In","Check-Out","Status","Tanggal"],...t.map(e=>{var a,t,s;return[e.name,e.kelasId,(null==(a=e.checkIn)?void 0:a.toDate)?e.checkIn.toDate().toLocaleTimeString():"-",(null==(t=e.checkOut)?void 0:t.toDate)?e.checkOut.toDate().toLocaleTimeString():"-",e.status,(null==(s=e.date)?void 0:s.toDate)?e.date.toDate().toLocaleDateString():"-"]})].map(e=>e.join(",")).join("\n")],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a");a.href=URL.createObjectURL(e),a.download="absensi_".concat(new Date().toISOString().split("T")[0],".csv"),a.click()},children:"Export CSV"})})]}),(0,s.jsx)("div",{className:"table-responsive",children:(0,s.jsxs)("table",{className:"table table-bordered table-hover",children:[(0,s.jsx)("thead",{className:"table-light",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Nama"}),(0,s.jsx)("th",{children:"Kelas"}),(0,s.jsx)("th",{children:"Check-In"}),(0,s.jsx)("th",{children:"Check-Out"}),(0,s.jsx)("th",{children:"Status"}),(0,s.jsx)("th",{children:"Tanggal"})]})}),(0,s.jsx)("tbody",{children:0===k.length?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:6,className:"text-center",children:"Tidak ada data"})}):k.map(e=>{var a,t,n;return(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:e.name}),(0,s.jsx)("td",{children:e.kelasId}),(0,s.jsx)("td",{children:(null==(a=e.checkIn)?void 0:a.toDate)?e.checkIn.toDate().toLocaleTimeString():"-"}),(0,s.jsx)("td",{children:(null==(t=e.checkOut)?void 0:t.toDate)?e.checkOut.toDate().toLocaleTimeString():"-"}),(0,s.jsx)("td",{children:e.status}),(0,s.jsx)("td",{children:(null==(n=e.date)?void 0:n.toDate)?e.date.toDate().toLocaleDateString():"-"})]},e.id)})})]})}),(0,s.jsx)("nav",{children:(0,s.jsxs)("ul",{className:"pagination",children:[(0,s.jsx)("li",{className:"page-item ".concat(1===j?"disabled":""),children:(0,s.jsx)("button",{className:"page-link",onClick:()=>p(e=>e-1),children:"Prev"})}),Array.from({length:g},(e,a)=>a+1).map(e=>(0,s.jsx)("li",{className:"page-item ".concat(e===j?"active":""),children:(0,s.jsx)("button",{className:"page-link",onClick:()=>p(e),children:e})},e)),(0,s.jsx)("li",{className:"page-item ".concat(j===g?"disabled":""),children:(0,s.jsx)("button",{className:"page-link",onClick:()=>p(e=>e+1),children:"Next"})})]})})]})]})}}},e=>{e.O(0,[636,593,792],()=>e(e.s=66020)),_N_E=e.O()}]);