(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[147],{31340:(e,a,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/students/edit/[id]",function(){return s(81697)}])},40482:(e,a,s)=>{"use strict";s.d(a,{A:()=>c});var i=s(37876),n=s(48230),t=s.n(n),l=s(89099),d=s(10323),r=s(14232);function c(){let e=(0,l.useRouter)();(0,d.xI)();let[a,s]=(0,r.useState)(!1),[n,c]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{let e=()=>{c(window.innerWidth<992),window.innerWidth>=992&&s(!0)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,i.jsxs)(i.Fragment,{children:[n&&(0,i.jsx)("button",{style:{position:"absolute",right:"0px"},className:"btn btn-dark m-2",onClick:()=>s(!a),children:"â˜° Menu"}),(0,i.jsxs)("div",{className:"bg-dark text-light position-fixed vh-100 p-3 transition",style:{width:"220px",zIndex:1e3,top:"0px",left:a?"0":"-240px",transition:"left 0.3s ease"},children:[(0,i.jsx)("div",{className:"mb-4",children:(0,i.jsx)("h5",{children:"SIS Dashboard"})}),(0,i.jsx)("ul",{className:"nav nav-pills flex-column mb-auto",children:[{name:"Dashboard",href:"/dashboard"},{name:"Kelas",href:"/classes"},{name:"Siswa",href:"/admin/students/siswa"},{name:"Absensi",href:"/attendance"},{name:"Rekap",href:"/reports"}].map(a=>(0,i.jsx)("li",{className:"nav-item",children:(0,i.jsx)(t(),{href:a.href,className:"nav-link text-light ".concat(e.pathname===a.href?"active bg-primary":""),children:a.name})},a.href))})]})]})}},81697:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>c});var i=s(37876),n=s(14232),t=s(89099),l=s(20485),d=s(98467),r=s(40482);function c(){let e=(0,t.useRouter)(),{id:a}=e.query,[s,c]=(0,n.useState)({name:"",nis:"",kelasId:"",photo:""}),[m,o]=(0,n.useState)([]),[h,u]=(0,n.useState)({});(0,n.useEffect)(()=>{!async function(){o((await (0,l.GG)((0,l.rJ)(d.db,"classes"))).docs.map(e=>({id:e.id,...e.data()})))}()},[]),(0,n.useEffect)(()=>{a&&s();async function s(){let s=(0,l.H9)(d.db,"students",a),i=await (0,l.x7)(s);i.exists()?c(i.data()):(alert("Siswa tidak ditemukan"),e.push("/admin/students/siswa"))}},[a]);let x=async()=>{let e={};return s.name||(e.name="Nama wajib diisi"),s.nis||(e.nis="NIS wajib diisi"),s.nis&&(await (0,l.GG)((0,l.rJ)(d.db,"students"))).docs.some(e=>e.data().nis===s.nis&&e.id!==a)&&(e.nis="NIS sudah digunakan"),s.kelasId||(e.kelasId="Kelas wajib dipilih"),u(e),0===Object.keys(e).length},f=async i=>{i.preventDefault(),await x()&&(await (0,l.mZ)((0,l.H9)(d.db,"students",a),s),alert("Data siswa berhasil diupdate"),e.push("/admin/students/siswa"))},b=e=>{c({...s,[e.target.name]:e.target.value})};return(0,i.jsxs)("div",{className:"d-flex flex-column flex-lg-row",children:[(0,i.jsxs)("div",{className:"col-lg-2 p-0",children:["        ",(0,i.jsx)(r.A,{})]}),(0,i.jsxs)("div",{className:"flex-grow-1 p-3",children:[(0,i.jsx)("h2",{className:"mb-4",children:"Edit Siswa"}),(0,i.jsxs)("form",{onSubmit:f,className:"col-12 col-md-6",children:[(0,i.jsxs)("div",{className:"mb-3",children:[(0,i.jsx)("label",{className:"form-label",children:"Nama"}),(0,i.jsx)("input",{type:"text",name:"name",className:"form-control ".concat(h.name?"is-invalid":""),value:s.name,onChange:b}),h.name&&(0,i.jsx)("div",{className:"invalid-feedback",children:h.name})]}),(0,i.jsxs)("div",{className:"mb-3",children:[(0,i.jsx)("label",{className:"form-label",children:"RFID"}),(0,i.jsx)("input",{type:"text",name:"rfid",className:"form-control ".concat(h.rfid?"is-invalid":""),value:s.rfid,onChange:b}),h.rfid&&(0,i.jsx)("div",{className:"invalid-feedback",children:h.rfid})]}),(0,i.jsxs)("div",{className:"mb-3",children:[(0,i.jsx)("label",{className:"form-label",children:"NIS"}),(0,i.jsx)("input",{type:"text",name:"nis",className:"form-control ".concat(h.nis?"is-invalid":""),value:s.nis,onChange:b}),h.nis&&(0,i.jsx)("div",{className:"invalid-feedback",children:h.nis})]}),(0,i.jsxs)("div",{className:"mb-3",children:[(0,i.jsx)("label",{className:"form-label",children:"Kelas"}),(0,i.jsxs)("select",{name:"kelasId",className:"form-select ".concat(h.kelasId?"is-invalid":""),value:s.kelasId,onChange:b,children:[(0,i.jsx)("option",{value:"",children:"Pilih Kelas"}),m.map(e=>(0,i.jsx)("option",{value:e.id,children:e.name},e.id))]}),h.kelasId&&(0,i.jsx)("div",{className:"invalid-feedback",children:h.kelasId})]}),(0,i.jsxs)("div",{className:"mb-3",children:[(0,i.jsx)("label",{className:"form-label",children:"Foto"}),(0,i.jsx)("input",{type:"file",className:"form-control",accept:"image/*",onChange:e=>{let a=e.target.files[0];if(!a)return;let i=new FileReader;i.onloadend=()=>{c({...s,photo:i.result})},i.readAsDataURL(a)}}),s.photo&&(0,i.jsx)("img",{src:s.photo,alt:"Foto Siswa",className:"mt-2 rounded",style:{width:"120px",height:"120px",objectFit:"cover"}})]}),(0,i.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Update"})]})]})]})}}},e=>{e.O(0,[636,593,792],()=>e(e.s=31340)),_N_E=e.O()}]);